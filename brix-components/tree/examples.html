<!DOCTYPE html>
<html>
    <head>
        <script src="//g-assets.daily.taobao.net/thx/brix-release/require-config-css.js"></script>
        <style>body {}</style>
    </head>
    <body>
        <div>
            <h3 class="fontsize-16">把扁平数据渲染成树结构。</h3>
            <div class="tree-wrapper" bx-name="components/tree" data-state="collapse">
                [
                    { id: '0', name: 'Loader' },
                    { id: '1', name: 'Base' },
                    { id: '2', name: 'Event' },
                
                    { id: '00', pid: '0', name: 'Loader.boot( context, complete, notify )' },
                    { id: '01', pid: '0', name: 'Loader.destroy( component, complete )' },
                    { id: '02', pid: '0', name: 'Loader.query( moduleId, context )' },
                    { id: '03', pid: '0', name: 'Loader.load( element, moduleId, options, complete )' },
                    { id: '04', pid: '0', name: 'Loader.unload( element, complete )' },
                    { id: '05', pid: '0', name: 'Loader.Options' },
                    { id: '06', pid: '0', name: 'Loader.Constant' },
                
                    { id: '10', pid: '1', name: '.init()' },
                    { id: '11', pid: '1', name: '.render()' },
                    { id: '12', pid: '1', name: '.destroy()' },
                    { id: '13', pid: '1', name: '.on( types, selector, data, fn )' },
                    { id: '14', pid: '1', name: '.one( types, selector, data, fn )' },
                    { id: '15', pid: '1', name: '.off( types, selector, fn )' },
                    { id: '16', pid: '1', name: '.trigger( type, data)' },
                    { id: '17', pid: '1', name: '.triggerHandler( type, data )' },
                
                    { id: '20', pid: '2', name: '.delegate( element, owner )' },
                    { id: '21', pid: '2', name: '.undelegate( element )' },
                
                    { id: '050', pid: '05', name: 'parse( element )' },
                    { id: '051', pid: '05', name: 'data( element )' },
                
                    { id: '060', pid: '06', name: 'VERSION' },
                    { id: '061', pid: '06', name: 'ATTRS' },
                    { id: '062', pid: '06', name: 'SELECTORS' },
                    { id: '063', pid: '06', name: 'EVENTS' },
                    { id: '064', pid: '06', name: 'OPTIONS' },
                    { id: '065', pid: '06', name: 'EXPANDO' },
                    { id: '066', pid: '06', name: 'UUID' }
                ]
            </div>
        </div>
        <div>
            <h3 class="fontsize-16">把扁平数据渲染成树结构。</h3>
            <div class="tree-wrapper" bx-name="components/tree">[{"id":2,"parentId":null,"name":"test2","order":1},{"id":3,"parentId":null,"name":"test3","order":2},{"id":1,"parentId":null,"name":"test1","order":3},{"id":12,"parentId":1,"name":"test12","order":1},{"id":11,"parentId":1,"name":"test11","order":2},{"id":32,"parentId":3,"name":"test32","order":3},{"id":21,"parentId":2,"name":"test21","order":4},{"id":31,"parentId":3,"name":"test31","order":5}]</div>
        </div>
        <div>
            <h3 class="fontsize-16">通过设置属性 <code>data-node-template</code> 自定义节点模板。</h3>
            <div class="tree-wrapper" bx-name="components/tree" data-node-template="custom/tree/node/template">
                [
                    { id: '华北', name: '华北' },
                    { id: '东北', name: '东北' },
                    { id: '华东', name: '华东' },
                    { id: '华南', name: '华南' },
                    { id: '华中', name: '华中' },
                    { id: '西南', name: '西南' },
                    { id: '西北', name: '西北' },
                    { id: '港澳台', name: '港澳台' },
                
                    { id: 110000, parentId: '华北', name: '北京市' },
                    { id: 120000, parentId: '华北', name: '天津市' },
                    { id: 130000, parentId: '华北', name: '河北省' },
                    { id: 140000, parentId: '华北', name: '山西省' },
                    { id: 150000, parentId: '华北', name: '内蒙古自治区' }
                ]
            </div>
            <script id="custom_tree_node_template" type="text/template">
                <div>
                    id: <%= id %>,
                    name: <span class="tree-node-content-name"><%= name %></span>,
                    <span style="float: right;">count: 9999</span>
                    operation: <a href="#" style="float: right;">+</a>
                </div>
            </script></script>
            <script>
                define('custom/tree/node/template', function() {
                    return document.getElementById('custom_tree_node_template').innerHTML
                })
            </script>
        </div>
        <div>
            <h3 class="fontsize-16">也可以在每条数据上附加一个 <code>content</code> 属性，指定节点渲染时的内容。</h3>
            <div class="tree-wrapper" bx-name="components/tree">
                [
                    { id: '华北', name: '华北', content: '<span class="tree-node-content-name"><i>hello</i></span><a href="#" style="float: right;">#</a>' },
                    { id: '东北', name: '东北' },
                    { id: '华东', name: '华东' },
                    { id: '华南', name: '华南' },
                    { id: '华中', name: '华中' },
                    { id: '西南', name: '西南' },
                    { id: '西北', name: '西北' },
                    { id: '港澳台', name: '港澳台' },
                
                    { id: 110000, parentId: '华北', name: '北京市', content: '<i>北京市</i>' },
                    { id: 120000, parentId: '华北', name: '天津市' },
                    { id: 130000, parentId: '华北', name: '河北省' },
                    { id: 140000, parentId: '华北', name: '山西省' },
                    { id: 150000, parentId: '华北', name: '内蒙古自治区' }
                ]
            </div>
        </div>
        <div>
            <h3 class="fontsize-16">方法 <code>.search( value )</code> 示例。</h3>
            <input class="form-control" id="searchInput">
            <div class="tree-wrapper" id="searchTree" bx-name="components/tree" data-node-template="custom/tree/node/template">
                [
                    { id: '华北', name: '华北' },
                    { id: '东北', name: '东北' },
                    { id: '华东', name: '华东' },
                    { id: '华南', name: '华南' },
                    { id: '华中', name: '华中' },
                    { id: '西南', name: '西南' },
                    { id: '西北', name: '西北' },
                    { id: '港澳台', name: '港澳台' },
                
                    { id: 110000, parentId: '华北', name: '北京市' },
                    { id: 120000, parentId: '华北', name: '天津市' },
                    { id: 130000, parentId: '华北', name: '河北省' },
                    { id: 140000, parentId: '华北', name: '山西省' },
                    { id: 150000, parentId: '华北', name: '内蒙古自治区' }
                ]
            </div>
            <script>
                require(['brix/loader', 'jquery'], function(Loader, $) {
                    Loader.boot(function(){
                        var tree = Loader.query($('#searchTree'))
                        $('#searchInput').on('keyup', function(event){
                            tree.search(event.target.value)
                        })
                    })
                })
            </script>
        </div>
        <div>
            <h3 class="fontsize-16">TagInput + Tree + SearchInput 示例</h3>
            <input class="form-control" id="demoTagInput" bx-name="components/taginput" data-suggest="false">
            <div class="input-group mt2">
                <input class="form-control" id="demoSearchInput" placeholder="华北"><span class="input-group-addon"><span class="glyphicon glyphicon-search"></span></span>
            </div>
            <div class="tree-wrapper" id="demoTree" bx-name="components/tree">
                [
                    { id: '华北', name: '华北', content: '<i class="tree-node-content-name">华北</i>' },
                    { id: '东北', name: '东北' },
                    { id: '华东', name: '华东' },
                    { id: '华南', name: '华南' },
                    { id: '华中', name: '华中' },
                    { id: '西南', name: '西南' },
                    { id: '西北', name: '西北' },
                    { id: '港澳台', name: '港澳台' },
                
                    { id: 110000, parentId: '华北', name: '北京市', content: '<i>北京市</i>' },
                    { id: 120000, parentId: '华北', name: '天津市' },
                    { id: 130000, parentId: '华北', name: '河北省' },
                    { id: 140000, parentId: '华北', name: '山西省' },
                    { id: 150000, parentId: '华北', name: '内蒙古自治区' }
                ]
            </div>
            <script>
                require(['brix/loader', 'jquery'], function(Loader, $) {
                    $('#demoSearchInput').on('keyup', function(event){
                        var tree = Loader.query($('#demoTree'))
                        tree.search(event.target.value)
                    })
                    Loader.boot(function(){
                        var tree = Loader.query($('#demoTree'))
                        tree.on('click.tree',function(event, data, target){
                            if (event.namespace !== 'tree') return
                            console.log(event, data, target)
                
                            var taginput = Loader.query($('#demoTagInput'))
                            taginput.add(data.name)
                        })
                        tree.on('mouseenter.tree mouseleave.tree',function(event, data, target){
                            // if (event.namespace !== 'tree') return
                            // console.log(event, data, target)
                        })
                    })
                })
            </script>
        </div>
        <div>
            <h3 class="fontsize-16">TagInput + Tree 的 <code>active</code>、<code>inactive</code> 事件示例。</h3>
            <input class="form-control" id="demoTagInput2" bx-name="components/taginput" data-suggest="false">
            <div class="tree-wrapper" id="demoTree2" bx-name="components/tree">
                [
                    { id: '华北', name: '华北', content: '<i class="tree-node-content-name">华北</i>' },
                    { id: '东北', name: '东北' },
                    { id: '华东', name: '华东' },
                    { id: '华南', name: '华南' },
                    { id: '华中', name: '华中' },
                    { id: '西南', name: '西南' },
                    { id: '西北', name: '西北' },
                    { id: '港澳台', name: '港澳台' },
                    { id: 110000, parentId: '华北', name: '北京市', content: '<i>北京市</i>' },
                    { id: 120000, parentId: '华北', name: '天津市' },
                    { id: 130000, parentId: '华北', name: '河北省' },
                    { id: 140000, parentId: '华北', name: '山西省' },
                    { id: 150000, parentId: '华北', name: '内蒙古自治区' }
                ]
            </div>
            <script>
                require(['brix/loader', 'jquery'], function(Loader, $) {
                    Loader.boot(function(){
                        var taginput = Loader.query($('#demoTagInput2'))[0]
                        var tree = Loader.query($('#demoTree2'))[0]
                
                        taginput.$relatedElement.on('click', function(event){
                            if ($(event.target).attr('class').indexOf('-remove') >= 0) return
                            if (taginput.val().length < 3) $(tree.element).show()
                        })
                
                        tree.on('click.tree', function(event, data, target) {
                            if (event.namespace !== 'tree') return
                            taginput.add(data.name)
                            if(taginput.val().length >= 3) $(tree.element).hide()
                        })
                
                        taginput.on('active.taginput inactive.taginput', function(event){
                            if (event.namespace !== 'taginput') return
                            console.log(event.type, event.namespace)
                        })
                        tree.on('active.tree inactive.tree', function(event){
                            if (event.namespace !== 'tree') return
                            console.log(event.type, event.namespace)
                        })
                    })
                })
                
            </script>
        </div>
        <script>
            require(['components/readme'], function(Readme) {
                // var readme = new Readme()
                // readme.trimHTML(document.body)
                // readme.trimPredefined(document.body)
            })
            require(['brix/loader', 'jquery', 'highlightjs'], function(Loader, $, hljs) {
                window.Loader = Loader
                Loader.boot(function() {
                    $('iframe', top.document).height(
                    	$(document.body).outerHeight() + 270
                	)
                    $(document.body).find('pre code').each(function(index, code) {
                        hljs.highlightBlock(code)
                    })
                })
            })
        </script>
        <script>
            require(['brix/loader', 'jquery'], function(Loader, $) {
                Loader.boot(function() {
                    var instances = Loader.query('components/tree')
                })
            })
        </script>
    </body>
</html>