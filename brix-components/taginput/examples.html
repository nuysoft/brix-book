<!DOCTYPE html>
<html>
    <head>
        <script src="http://g-assets.daily.taobao.net/thx/brix-release/require-config-css.js"></script>
        <style>
            body {
                padding: 10px;
            }
        </style>
    </head>
    <body>
        <div>
            <input class="form-control" bx-name="components/taginput">
        </div>
        <div>
            <h3 class="fontsize-16">通过 HTML 属性 <code>data-data</code> 指定初始值。</h3>
            <input class="form-control" bx-name="components/taginput" data-data="['foo', 'bar', 'baz']">
        </div>
        <div>
            <h3 class="fontsize-16">通过 HTML 属性 <code>data-placeholder</code> 指定描述预期值的简短提示。</p></h3>
            <input class="form-control" bx-name="components/taginput" data-placeholder="输入几个字符试试">
        </div>
        <div>
            <h3 class="fontsize-16">可以限制词条的个数。</h3>
            <input class="form-control" bx-name="components/taginput" data-limit="3">
        </div>
        <div>
            <h3 class="fontsize-16">不允许增加重复值。</h3>
            <input class="form-control" bx-name="components/taginput" data-limit="3" data-same="false">
        </div>
        <div>
            <h3 class="fontsize-16">设置属性 <code>data-suggest="false"</code> 可以关闭 Suggest 组件。</h3>
            <input class="form-control" bx-name="components/taginput" data-suggest="false">
        </div>
        <script>
            require(['components/readme'], function(Readme) {
                // var readme = new Readme()
                // readme.trimHTML(document.body)
                // readme.trimPredefined(document.body)
            })
            require(['brix/loader', 'jquery', 'highlightjs'], function(Loader, $, hljs) {
                window.Loader = Loader
                Loader.boot(function() {
                    $('iframe', top.document).height(
                    	$(document.body).outerHeight() + 270
                	)
                    $(document.body).find('pre code').each(function(index, code) {
                        hljs.highlightBlock(code)
                    })
                })
            })
        </script>
        <script>
            require(['brix/loader', 'jquery', 'underscore', 'mock'], function(Loader, $, _, Mock) {
                Loader.boot(function() {
                    var data = Mock.mock({
                        'list|5-100': ['@NAME', 'N@NATURAL']
                    }).list
                    var instances = Loader.query('components/taginput')
                    instances.on('change.taginput', function(event, data, action, value) {
                        console.log(event, data, action, value)
                    })
                    _.each(instances, function(taginput, index) {
                        taginput.on('change.suggest.input', function(event, value) {
                            if (!event.namespace) return
                            // if (!value) taginput.suggest.data([])
                            taginput.suggest.data(
                                _.difference(
                                    _.filter(data, function(item, index) {
                                        return ('' + item).indexOf(value) !== -1
                                    })
                                    , taginput.val()
                                )
                            )
                        })
                    })
                })
            })
        </script>
    </body>
</html>